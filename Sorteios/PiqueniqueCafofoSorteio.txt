adm = "Bleseaze#8245"
nome = "<p align='center'><font size='20' color='#C3A13C'>Sorteio de teste"
mapa = [[<C><P d="x_transformice/x_evt/x_evt_01/kjneb75/herbe.png,6,-5" D="x_transformice/x_evt/x_evt_01/kjneb75/map-nouvel-an.jpg,0,0" DS="y;366" Ca="" mc="" MEDATA="1,1;;;;-0;0:::1-"/><Z><S><S T="12" X="232" Y="420" L="2400" H="81" P="0,0,0.3,0.2,0,0,0,0" o="367e5c" m=""/><S T="12" X="338" Y="300" L="2400" H="15" P="0,0,0.3,0.2,0,0,0,0" o="367e5c" m=""/><S T="12" X="176" Y="221" L="30" H="15" P="0,0,0.3,0.2,-15,0,0,0" o="367e5c" m=""/><S T="12" X="204" Y="216" L="30" H="15" P="0,0,0.3,0.2,-5,0,0,0" o="367e5c" m=""/><S T="12" X="233" Y="215" L="30" H="15" P="0,0,0.3,0.2,0,0,0,0" o="367e5c" m=""/><S T="12" X="262" Y="217" L="30" H="15" P="0,0,0.3,0.2,5,0,0,0" o="367e5c" m=""/><S T="12" X="290" Y="222" L="30" H="15" P="0,0,0.3,0.2,10,0,0,0" o="367e5c" m=""/><S T="12" X="310" Y="243" L="50" H="15" P="0,0,0.3,0.2,60,0,0,0" o="367e5c" m=""/><S T="12" X="322" Y="258" L="50" H="15" P="0,0,0.3,0.2,50,0,0,0" o="367e5c" m=""/><S T="12" X="154" Y="238" L="30" H="15" P="0,0,0.3,0.2,-70,0,0,0" o="367e5c" m=""/><S T="12" X="159" Y="226" L="10" H="15" P="0,0,0.3,0.2,-25,0,0,0" o="367e5c" m=""/><S T="12" X="145" Y="265" L="30" H="15" P="0,0,0.3,0.2,-75,0,0,0" o="367e5c" m=""/><S T="12" X="372" Y="317" L="33" H="10" P="0,0,0.3,0.2,55,0,0,0" o="367e5c" m=""/><S T="12" X="61" Y="293" L="30" H="15" P="0,0,0.3,0.2,45,0,0,0" o="367e5c" m=""/><S T="12" X="12" Y="268" L="50" H="15" P="0,0,0.3,0.2,25,0,0,0" o="367e5c" m=""/><S T="12" X="43" Y="276" L="15" H="15" P="0,0,0.3,0.2,20,0,0,0" o="367e5c" m=""/><S T="12" X="52" Y="281" L="15" H="15" P="0,0,0.3,0.2,50,0,0,0" o="367e5c" m=""/><S T="12" X="337" Y="288" L="30" H="15" P="0,0,0.3,0.2,90,0,0,0" o="367e5c" m=""/><S T="12" X="343" Y="301" L="30" H="15" P="0,0,0.3,0.2,50,0,0,0" o="367e5c" m=""/><S T="12" X="353" Y="308" L="30" H="15" P="0,0,0.3,0.2,10,0,0,0" o="367e5c" m=""/><S T="12" X="510" Y="310" L="40" H="10" P="0,0,0.3,0.2,140,0,0,0" o="367e5c" m=""/><S T="12" X="-10" Y="205" L="20" H="500" P="0,0,0.3,0.2,0,0,0,0" o="367e5c" m=""/><S T="12" X="791" Y="-56" L="2400" H="81" P="0,0,0.3,1,0,0,0,0" o="367e5c" m=""/><S T="12" X="809" Y="171" L="20" H="420" P="0,0,0.3,0.2,0,0,0,0" o="367e5c" m=""/><S T="12" X="788" Y="246" L="30" H="15" P="0,0,0.3,0.2,20,0,0,0" o="367e5c" m=""/><S T="12" X="761" Y="237" L="30" H="15" P="0,0,0.3,0.2,15,0,0,0" o="367e5c" m=""/><S T="12" X="735" Y="231" L="30" H="15" P="0,0,0.3,0.2,5,0,0,0" o="367e5c" m=""/><S T="12" X="715" Y="238" L="30" H="15" P="0,0,0.3,0.2,-45,0,0,0" o="367e5c" m=""/><S T="12" X="699" Y="260" L="30" H="15" P="0,0,0.3,0.2,-65,0,0,0" o="367e5c" m=""/><S T="12" X="691" Y="283" L="30" H="15" P="0,0,0.3,0.2,-75,0,0,0" o="367e5c" m=""/><S T="12" X="569" Y="199" L="10" H="10" P="0,0,0.3,0.2,-10,0,0,0" o="367e5c" m=""/><S T="12" X="573" Y="213" L="10" H="30" P="0,0,0.3,0.2,-20,0,0,0" o="367e5c" m=""/><S T="12" X="583" Y="219" L="15" H="10" P="0,0,0.3,0.2,-30,0,0,0" o="367e5c" m=""/><S T="12" X="579" Y="240" L="10" H="30" P="0,0,0.3,0.2,0,0,0,0" o="367e5c" m=""/><S T="12" X="657" Y="293" L="20" H="15" P="0,0,0.3,0.2,-25,0,0,0" o="367e5c" m=""/><S T="12" X="669" Y="294" L="20" H="15" P="0,0,0.3,0.2,35,0,0,0" o="367e5c" m=""/><S T="12" X="519" Y="287" L="80" H="15" P="0,0,0.3,0.2,-75,0,0,0" o="367e5c" m=""/><S T="12" X="574" Y="253" L="100" H="15" P="0,0,0.3,1,0,0,0,0" o="367e5c" m=""/><S T="12" X="636" Y="283" L="60" H="15" P="0,0,0.3,0.2,65,0,0,0" o="367e5c" m=""/><S T="12" X="382" Y="332" L="33" H="10" P="0,0,0.3,0.2,25,0,0,0" o="367e5c" m=""/><S T="12" X="125" Y="287" L="30" H="15" P="0,0,0.3,0.2,-15,0,0,0" o="367e5c" m=""/><S T="12" X="98" Y="296" L="30" H="15" P="0,0,0.3,0.2,-25,0,0,0" o="367e5c" m=""/><S T="12" X="77" Y="303" L="30" H="15" P="0,0,0.3,0.2,5,0,0,0" o="367e5c" m=""/><S T="12" X="54" Y="126" L="50" H="10" P="1,0,0.3,0.2,-20,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="-51" Y="129" L="50" H="10" P="1,0,0.3,0.2,50,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="97" Y="108" L="50" H="10" P="1,0,0.3,0.2,-30,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="17" Y="140" L="50" H="10" P="1,0,0.3,0.2,-20,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="-22" Y="146" L="50" H="10" P="1,0,0.3,0.2,0,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="257" Y="-13" L="50" H="10" P="1,0,0.3,0.2,-70,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="237" Y="14" L="50" H="10" P="1,0,0.3,0.2,-40,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="206" Y="41" L="50" H="10" P="1,0,0.3,0.2,-40,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="171" Y="66" L="50" H="10" P="1,0,0.3,0.2,-30,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="133" Y="88" L="50" H="10" P="1,0,0.3,0.2,-30,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="235" Y="16" L="50" H="10" P="1,0,0.3,0.2,50,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="268" Y="40" L="50" H="10" P="1,0,0.3,0.2,20,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="349" Y="51" L="50" H="10" P="1,0,0.3,0.2,-10,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="308" Y="52" L="50" H="10" P="1,0,0.3,0.2,10,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="388" Y="41" L="50" H="10" P="1,0,0.3,0.2,-20,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="425" Y="24" L="50" H="10" P="1,0,0.3,0.2,-30,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="461" Y="4" L="50" H="10" P="1,0,0.3,0.2,-30,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="208" Y="-11" L="50" H="10" P="1,0,0.3,0.2,40,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="479" Y="-25" L="50" H="10" P="1,0,0.3,0.2,-80,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="645" Y="0" L="50" H="10" P="1,0,0.3,0.2,-120,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="668" Y="33" L="50" H="10" P="1,0,0.3,0.2,-130,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="700" Y="57" L="50" H="10" P="1,0,0.3,0.2,-160,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="741" Y="68" L="50" H="10" P="1,0,0.3,0.2,-170,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="782" Y="71" L="50" H="10" P="1,0,0.3,0.2,-180,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="823" Y="64" L="50" H="10" P="1,0,0.3,0.2,-200,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="630" Y="-40" L="50" H="10" P="1,0,0.3,0.2,-280,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="857" Y="44" L="50" H="10" P="1,0,0.3,0.2,-220,0,0,0" o="da38d0" c="4" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="62" Y="154" L="32" H="43" P="1,0,0.3,0.2,0,0,0,1" o="324c50" c="3" N="" i="-57,-64,x_transformice/x_evt/x_evt_01/kjneb75/loupiote1.png"/><S T="12" X="58" Y="130" L="20" H="10" P="1,0,0.3,0.2,-60,0,0,0" o="da38d0" c="4" m="" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="138" Y="115" L="32" H="43" P="1,0,0.3,0.2,0,0,0,1" o="324c50" c="3" N="" i="-57,-64,x_transformice/x_evt/x_evt_01/kjneb75/loupiote1.png"/><S T="12" X="212" Y="76" L="32" H="43" P="1,0,0.3,0.2,-30,0,0,1" o="324c50" c="3" N="" i="-57,-64,x_transformice/x_evt/x_evt_01/kjneb75/loupiote1.png"/><S T="12" X="66" Y="130" L="20" H="10" P="1,0,0.3,0.2,-120,0,0,0" o="da38d0" c="4" m="" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="142" Y="92" L="20" H="10" P="1,0,0.3,0.2,-120,0,0,0" o="da38d0" c="4" m="" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="204" Y="55" L="20" H="10" P="1,0,0.3,0.2,-160,0,0,0" o="da38d0" c="4" m="" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="134" Y="93" L="20" H="10" P="1,0,0.3,0.2,-60,0,0,0" o="da38d0" c="4" m="" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="198" Y="60" L="20" H="10" P="1,0,0.3,0.2,-90,0,0,0" o="da38d0" c="4" m="" i="0,0,x_transformice/x_evt/x_evt_01/kjneb75/corde.png"/><S T="12" X="263" Y="53" L="30" H="40" P="1,0,0.3,0.2,20,0,0,0" o="324c50" c="3" i="-16,-22,x_transformice/x_evt/x_evt_01/kjneb75/fanion.png"/><S T="12" X="305" Y="66" L="30" H="40" P="1,0,0.3,0.2,10,0,0,0" o="324c50" c="3" i="-16,-22,x_transformice/x_evt/x_evt_01/kjneb75/fanion.png"/><S T="12" X="352" Y="66" L="30" H="40" P="1,0,0.3,0.2,-10,0,0,0" o="324c50" c="3" i="-16,-22,x_transformice/x_evt/x_evt_01/kjneb75/fanion.png"/><S T="12" X="393" Y="55" L="30" H="40" P="1,0,0.3,0.2,-20,0,0,0" o="324c50" c="3" i="-16,-22,x_transformice/x_evt/x_evt_01/kjneb75/fanion.png"/><S T="12" X="431" Y="36" L="30" H="40" P="1,0,0.3,0.2,-30,0,0,0" o="324c50" c="3" i="-16,-22,x_transformice/x_evt/x_evt_01/kjneb75/fanion.png"/><S T="12" X="467" Y="16" L="30" H="40" P="1,0,0.3,0.2,-30,0,0,0" o="324c50" c="3" i="-16,-22,x_transformice/x_evt/x_evt_01/kjneb75/fanion.png"/><S T="12" X="645" Y="0" L="20" H="20" P="1,0,0.3,0.2,-30,0,0,0" o="324c50" c="3" i="-30,-40,x_transformice/x_evt/x_evt_01/kjneb75/loupiote2.png"/><S T="12" X="660" Y="39" L="20" H="20" P="1,0,0.3,0.2,50,0,0,0" o="324c50" c="3" i="-30,-40,x_transformice/x_evt/x_evt_01/kjneb75/loupiote2.png"/><S T="12" X="696" Y="66" L="20" H="20" P="1,0,0.3,0.2,20,0,0,0" o="324c50" c="3" i="-30,-40,x_transformice/x_evt/x_evt_01/kjneb75/loupiote2.png"/><S T="12" X="739" Y="78" L="20" H="20" P="1,0,0.3,0.2,10,0,0,0" o="324c50" c="3" i="-30,-40,x_transformice/x_evt/x_evt_01/kjneb75/loupiote2.png"/><S T="12" X="782" Y="81" L="20" H="20" P="1,0,0.3,0.2,0,0,0,0" o="324c50" c="3" i="-30,-40,x_transformice/x_evt/x_evt_01/kjneb75/loupiote2.png"/><S T="12" X="591" Y="372" L="26" H="30" P="0,0,0.3,0.2,180,0,0,0" o="367e5c" m=""/><S T="12" X="460" Y="370" L="26" H="30" P="0,0,0.3,0.2,180,0,0,0" o="367e5c" m=""/></S><D/><O><O X="33" Y="133" C="14" P="0"/><O X="113" Y="98" C="14" P="0"/><O X="152" Y="77" C="14" P="0"/><O X="188" Y="57" C="14" P="0"/><O X="222" Y="27" C="14" P="0"/><O X="-64" Y="116" C="11" P="0"/><O X="264" Y="-33" C="11" P="0"/><O X="-2" Y="146" C="14" P="0"/><O X="252" Y="2" C="14" P="0"/><O X="-40" Y="146" C="14" P="0"/><O X="77" Y="118" C="14" P="0"/><O X="483" Y="-45" C="11" P="0"/><O X="192" Y="-23" C="11" P="0"/><O X="223" Y="2" C="14" P="0"/><O X="248" Y="32" C="14" P="0"/><O X="285" Y="46" C="14" P="0"/><O X="331" Y="54" C="14" P="0"/><O X="367" Y="48" C="14" P="0"/><O X="406" Y="34" C="14" P="0"/><O X="445" Y="13" C="14" P="0"/><O X="478" Y="-5" C="14" P="0"/><O X="626" Y="-58" C="11" P="0"/><O X="870" Y="32" C="11" P="0"/><O X="632" Y="-20" C="14" P="0"/><O X="654" Y="15" C="14" P="0"/><O X="681" Y="49" C="14" P="0"/><O X="722" Y="64" C="14" P="0"/><O X="763" Y="70" C="14" P="0"/><O X="802" Y="69" C="14" P="0"/><O X="841" Y="57" C="14" P="0"/><O X="61" Y="124" C="14" P="0"/><O X="55" Y="137" C="14" P="0"/><O X="70" Y="136" C="14" P="0"/><O X="131" Y="100" C="14" P="0"/><O X="145" Y="97" C="14" P="0"/><O X="137" Y="85" C="14" P="0"/><O X="197" Y="65" C="14" P="0"/><O X="211" Y="57" C="14" P="0"/><O X="196" Y="52" C="14" P="0"/><O X="259" Y="37" C="22" P="0"/><O X="277" Y="43" C="22" P="0"/><O X="343" Y="53" C="22" P="0"/><O X="357" Y="52" C="22" P="0"/><O X="452" Y="8" C="22" P="0"/><O X="467" Y="0" C="22" P="0"/><O X="298" Y="50" C="22" P="0"/><O X="317" Y="54" C="22" P="0"/><O X="378" Y="44" C="22" P="0"/><O X="394" Y="37" C="22" P="0"/><O X="415" Y="28" C="22" P="0"/><O X="431" Y="17" C="22" P="0"/><O X="644" Y="0" C="22" P="0"/><O X="665" Y="35" C="22" P="0"/><O X="699" Y="59" C="22" P="0"/><O X="740" Y="70" C="22" P="0"/><O X="782" Y="74" C="22" P="0"/></O><L/></Z></C>]]
participante = {}
inicio = false
fim = false
qtd = 0
fast = 0
ganhadores = {}
local sorteioEmAndamento = false
tfm.exec.disableAfkDeath(true)
	tfm.exec.playSound('/cite18/amb/302.mp3', 10, nil, nil, nil)
	tfm.exec.playSound('/deadmaze/x_amb_feu.mp3', 10, nil, nil, nil)

musica = math.random(0, 2)
if musica == 0 then
    tfm.exec.playSound('/cite18/musique/intro.mp3', 50, nil, nil, nil)
elseif musica == 1 then
    tfm.exec.playSound('/cite18/musique/intro2.mp3', 50, nil, nil, nil)
elseif musica == 2 then
    tfm.exec.playSound('/deadmaze/x_musique_3.mp3', 50, nil, nil, nil)
end

function eventTextAreaCallback(id, p, cmd)
    if cmd == "entrada" then
        ui.addTextArea(0, "<p align='center'>Participando", p, 200, 370, 340, 20, 1, 0x00FF00, 0, false)
        setPlayerNameColorGreen(p)
        entrada(p, #participante + 1)
    elseif cmd == "inicio" then
        ui.addPopup(0, 2, "<p align='center'>Quantidade de sorteados", p, 300, 200, 200, false)
    elseif cmd == "novo" then
        novo()
    elseif cmd == "reviver" then
        reviver(p)
    elseif cmd == "lista" then
        verLista(p)
    elseif cmd == "verGanhadores" then
        verGanhadores(p)
    elseif cmd == "fecharGanhadores" then
        fecharGanhadores(p)
    elseif cmd == "fechar" then
        fecharLista(p)
    elseif cmd == "discord" then
        ui.addPopup(0, 2, "<p align='center'>❥ Nosso servidor: discord.gg/2pvpJC2Y9g", p, 200, 230, 340, false)
    elseif cmd == "instagram" then
        ui.addPopup(0, 2, "<p align='center'>❥ Perfil oficial: @purple.peacocks", p, 200, 230, 340, false)
    end
end

function entrada(p, num)
    if not participando(p) then
        participante[num] = p
    end
end

function novo()
    for i = 1, #participante do
        table.remove(participante, 1)
    end
    tfm.exec.playSound('/cite18/np-esprit.mp3', 100, nil, nil, nil)
    ui.addTextArea(-7, "<p align='center'><a href='event:verGanhadores'>Ver Ganhadores", nil, 30, 330, 150, 20, 1, 0x00FFFF, 0.5, false)
    ui.addTextArea(0, "<p align='center'><a href='event:entrada'>Participar do sorteio!", nil, 200, 370, 340, 20, 1, 0xFF0000, 0.8, false)
    ui.addTextArea(-1, "<p align='center'><a href='event:inicio'>Iniciar", adm, 560, 370, 100, 20, 1, 0x0000FF, 0.5, false)
    ui.addTextArea(-2, "<p align='center'><a href='event:lista'>Lista de participantes", nil, 30, 370, 150, 20, 1, 0xFF00FF, 0.5, false)
    ui.addTextArea(-4, "<p align='center'><a href='event:discord'>Discord</a> | <a href='event:instagram'>Instagram</a>", p, 200, 340, 340, 20, 1, 0x000000, 0, false)
    ui.addTextArea(-3, "<p align='center'><font size='20px'>"..nome, nil, 170, 40, 425, 30, 1, 0xC3A13C, 0.5, false)

    tfm.exec.removePhysicObject(0)
    fim = false
end

function reviver(p)
    tfm.exec.respawnPlayer(p)
end

function eventoGanhador(nomeGanhador)
    table.insert(ganhadores, nomeGanhador)
end

function sortearGanhador()
    local ganhador
    repeat
        ganhador = math.random(1, #participante)
    until not ganhadores[ganhador]
    return ganhador
end

function eventPopupAnswer(id, p, cmd)
    if tonumber(cmd, 10) then
        if tonumber(cmd, 10) >= 1 and tonumber(cmd, 10) <= #participante then
            ui.removeTextArea(0, nil)
            ui.removeTextArea(-1, nil)
            qtd = tonumber(cmd, 10)
            fast = math.random(25, 30)
            inicio = true
        end
    end
end

function eventNewPlayer(p)
		tfm.exec.respawnPlayer(p)
    if not inicio and not fim then
        reviver(p)
    ui.addTextArea(0, "<p align='center'><a href='event:entrada'>Participar do sorteio!", p, 200, 370, 340, 20, 1, 0xFF0000, 0.8, false)
        ui.addTextArea(-7, "<p align='center'><a href='event:verGanhadores'>Ver Ganhadores", nil, 30, 330, 150, 20, 1, 0x00FFFF, 0.5, false)
        ui.addTextArea(-2, "<p align='center'><a href='event:lista'>Lista de participantes", nil, 30, 370, 150, 20, 1, 0xFF00FF, 0.5, false)
			ui.addTextArea(-3, "<p align='center'><font size='20px'>"..nome, nil, 170, 40, 425, 30, 1, 0xC3A13C, 0.5, false)
        ui.addTextArea(-4, "<p align='center'><a href='event:discord'>Discord</a> | <a href='event:instagram'>Instagram</a>", p, 200, 340, 340, 20, 1, 0x000000, 0, false)
    end
end

function eventPlayerDied(p)
	tfm.exec.respawnPlayer(p)
end

function eventLoop()
    if inicio then
        if fast > 0 then
            sorteioEmAndamento = true  -- Sorteio está em andamento
					tfm.exec.playSound('/cite18/rubis.mp3', 100, nil, nil, nil)
					ui.addTextArea(1000, "<p align='center'><font color='#E7B200'><b>Processando...", nil, 170, 370, 400, 20, 1, 0xFECCFF, 0, false)
            local ganhador = sortearGanhador()
            if ganhador then
                mostrarGanhador(ganhador)
                fast = fast - 1
            end
        else
            sorteioEmAndamento = false  -- Sorteio não está em andamento
            inicio = false
            fim = true
            ui.addTextArea(-1, "<p align='center'><a href='event:novo'>Novo sorteio", adm, 560, 370, 100, 20, 1, 0x0000FF, 0.5, false)
            local ganhador = sortearGanhador()
            if ganhador then
					tfm.exec.playSound('/deadmaze/sons/11.mp3', 100, nil, nil, nil)
                tfm.exec.giveCheese(participante[ganhador])
                tfm.exec.setNameColor(participante[ganhador], 0xFFCC23)
                eventoGanhador(participante[ganhador])
    				ui.removeTextArea(ganhador, nil)
    				ui.addTextArea(ganhador, "<p align='center'><font size='30' color='#5CFF00'>" .. participante[ganhador], nil, 230, 130, 300, 40, 1, 0x5CFF00, 1, false)
                ui.addTextArea(1000, "<p align='center'><font color='#00FF1B'><b>Sorteio encerrado!", nil, 170, 370, 400, 20, 1, 0x6E27FD, 0, false)
					tfm.exec.changePlayerSize (participante[ganhador], 2)
					tfm.exec.movePlayer (participante[ganhador], 400, 100)
                tfm.exec.playEmote (participante[ganhador], 0, nil)
            end
        end
    end
end

function participando(p)
    for i, v in pairs(participante) do
        if v == p then
            return true
        end
    end
    return false
end

function mostrarGanhador(ganhador)
    for i = 1, #participante do
        if i ~= ganhador then
            ui.removeTextArea(i, nil)
        end
    end

    coresaleatorio = math.random(0, 5)
    if sorteioEmAndamento == true then
 		if coresaleatorio == 0 then
			   corTexto = "#FF0000"
			elseif coresaleatorio == 1 then
			   corTexto = "#FF7100"
			elseif coresaleatorio == 2 then
			   corTexto = "#FFD700"
 		elseif coresaleatorio == 3 then
			   corTexto = "#22E5FF"
			elseif coresaleatorio == 4 then
			   corTexto = "#C5FF22"
			elseif coresaleatorio == 5 then
			   corTexto = "#F100FF"
			end
		end

    ui.addTextArea(ganhador, "<p align='center'><font size='30' color='" ..corTexto.. "'>" .. participante[ganhador], nil, 180, 130, 400, 80, 1, 1, 0, false)
end

tfm.exec.disableAutoShaman(true)
tfm.exec.disableAutoNewGame(true)
math.randomseed(os.time())
tfm.exec.newGame(mapa)
ui.addTextArea(-7, "<p align='center'><a href='event:verGanhadores'>Ver Ganhadores", nil, 30, 330, 150, 20, 1, 0x00FFFF, 0.5, false)
ui.addTextArea(0, "<p align='center'><a href='event:entrada'>Participar do sorteio!", nil, 200, 370, 340, 20, 1, 0xFF0000, 0.8, false)
ui.addTextArea(-1, "<p align='center'><a href='event:inicio'>Iniciar", adm, 560, 370, 100, 20, 1, 0x0000FF, 0.5, false)
ui.addTextArea(-2, "<p align='center'><a href='event:lista'>Lista de participantes", nil, 30, 370, 150, 20, 1, 0xFF00FF, 0.5, false)
ui.addTextArea(-3, "<p align='center'><font size='20px'>"..nome, nil, 170, 40, 425, 30, 1, 0xC3A13C, 0.5, false)
ui.addTextArea(-4, "<p align='center'><a href='event:discord'>Discord</a> | <a href='event:instagram'>Instagram</a>", p, 200, 340, 340, 20, 1, 0x000000, 0, false)
tfm.exec.setUIMapName("Script de sorteios | editado por: Bleseaze#8245")

function eventTextAreaCallback(id, p, cmd)
    if cmd == "entrada" then
        ui.addTextArea(0, "<p align='center'>Participando", p, 200, 370, 340, 20, 1, 0x00FF00, 0.8, false)
        entrada(p, #participante + 1)
        setPlayerNameColorGreen(p)
    elseif cmd == "inicio" then
        ui.addPopup(0, 2, "<p align='center'>Quantidade de sorteados", p, 300, 200, 200, false)
    elseif cmd == "novo" then
        novo()
    elseif cmd == "reviver" then
        reviver(p)
    elseif cmd == "lista" then
        verLista(p)
    elseif cmd == "verGanhadores" then
        verGanhadores(p) -- Chama a função para exibir a lista de ganhadores
    elseif cmd == "fecharGanhadores" then
        fecharGanhadores(p) -- Chama a função para fechar a lista de ganhadores
    elseif cmd == "fechar" then
        fecharLista(p)
    elseif cmd == "discord" then
        ui.addPopup(0, 2, "<p align='center'>❥ Nosso servidor: discord.gg/2pvpJC2Y9g", p, 200, 230, 340, false)
    elseif cmd == "instagram" then
        ui.addPopup(0, 2, "<p align='center'>❥ Perfil oficial: @purple.peacocks", p, 200, 230, 340, false)
    end
end

function verLista(p)
	local listaParticipantes = "<p align='center'><font size='14px'><b>Lista de Participantes:</b></font><br><br>"
	for i, v in pairs(participante) do
		listaParticipantes = listaParticipantes .. v .. "<br>"
	end
	ui.addTextArea(-5, listaParticipantes .. "<br><br><p align='center'><a href='event:fechar'>Fechar</a>", p, 200, 100, 400, 250, 1, 1, 0.6, false)
end

function fecharLista(p)
	ui.removeTextArea(-5, p)
end

-- Lista de ganhadores
local ganhadores = {}

function verGanhadores(p)
    local listaGanhadores = "<p align='center'><font size='14px'><b>Lista de Ganhadores:</b></font><br><br>"
    for i, v in ipairs(ganhadores) do
        listaGanhadores = listaGanhadores .. v .. "<br>"
    end
    ui.addTextArea(-6, listaGanhadores .. "<br><br><p align='center'><a href='event:fecharGanhadores'>Fechar</a>", p, 200, 100, 400, 250, 1, 1, 0.6, false)
end

function fecharGanhadores(p)
    ui.removeTextArea(-6, p)
end

function setPlayerNameColorGreen(player)
    tfm.exec.setNameColor(player, 0x00FF00)
end

function eventoGanhador(nomeGanhador)
    table.insert(ganhadores, nomeGanhador)
end
tfm.exec.addNPC("Bleseaze",{title = 70, look = "278;79_a1f0f2+5f7ad6+ccf6fd+a1f0f2+c1c3de,0,0,0,72_f7e4e1+f7e4e1+f7e4e1+725cf7+564dcb+3831f8+f7e4e1+6b69ec+2d1ae0,55_f0e8e0+3650db,0,84,0,0,0,0",x = 760,y = 365,female = false,lookLeft = false,lookAtPlayer = true,interactive = true},name)

function eventTalkToNPC(name, npc)
	if npc == "Bleseaze" then
		showMessage("<V>[Bleseaze] <N>Bem-vindo à tribo Purple Peacocks! Para participar do sorteio basta estar apertando no botão abaixo, então boa sorte! Lembrando que temos sorteios diários às 12h, 18h e 21h",name)
		end
end

function showMessage(message,name)
	temp_text=string.gsub(message,"<b>","")
	temp_text=string.gsub(temp_text,"</b>","")
	if tfm.get.room.isTribeHouse == false then
		tfm.exec.chatMessage(message,name)
	else
		ui.addPopup(0,0,temp_text,name,180,175,400,true)
	end
end